(function(e){function t(t){for(var r,i,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)i=s[d],o[i]&&p.push(o[i][0]),o[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(p.length)p.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],r=!0,s=1;s<a.length;s++){var l=a[s];0!==o[l]&&(r=!1)}r&&(n.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},o={app:0},n=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0170":function(e,t,a){},"0259":function(e,t,a){"use strict";var r=a("7fff"),o=a.n(r);o.a},"034f":function(e,t,a){"use strict";var r=a("c21b"),o=a.n(r);o.a},"115a":function(e,t,a){"use strict";var r=a("504d"),o=a.n(r);o.a},3064:function(e,t,a){},"504d":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("9393"),o=(a("cadf"),a("551c"),a("097d"),a("2b0e")),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.selections.length?a("region-picker"):e._e(),a("h3",[e._v("Your studies")]),a("studies-vlist",{attrs:{items:e.selections}}),a("button",{staticClass:"btn btn-info mx-auto-auto",on:{click:function(t){e.showModal=!0}}},[e._v("Add a dataset")]),e.showModal?a("adder-wizard",{on:{"config-ready":e.sendConfig,close:function(t){e.showModal=!1}}}):e._e()],1)},i=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{staticClass:"modal-container"},[a("div",{staticClass:"modal-header"},[a("h3",[e._v("Add a GWAS")]),a("button",{staticClass:"pull-right",attrs:{"aria-label":"close"},on:{click:function(t){e.$emit("close")}}},[e._v("X")])]),a("div",{staticClass:"modal-body"},["select_source"===e.currentPage?a("div",[e.adderMode?"file"===e.adderMode?a("div",[a("tabix-file",{on:{connected:e.connectReader}})],1):"url"===e.adderMode?a("div",[a("tabix-url",{on:{connected:e.connectReader}})],1):e._e():a("div",[a("p",[e._v("How would you like to load your data?")]),a("div",{staticClass:"text-center"},[a("button",{staticClass:"btn btn-info",on:{click:function(t){e.adderMode="file"}}},[e._v("\n                  Local file\n                ")]),a("br"),e._v("\n                or"),a("br"),a("button",{staticClass:"btn btn-info",on:{click:function(t){e.adderMode="url"}}},[e._v("\n                  Remote URL\n                ")])])])]):"select_options"===e.currentPage?a("div",[a("parser-options",{attrs:{chr_col:e.readerChrCol,pos_col:e.readerPosCol,column_titles:e.readerHeaders,sample_data:e.readerDataRow},on:{connected:e.connectParser}})],1):"accept_options"===e.currentPage?a("div",[a("label",[e._v("Name: "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.previewName,expression:"previewName"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.previewName},on:{input:function(t){t.target.composing||(e.previewName=t.target.value)}}})]),a("button",{staticClass:"btn btn-primary",on:{click:e.sendOptions}},[e._v("\n              Add to plot\n            ")])]):a("div",{staticClass:"text-error"},[e._v("\n            You have reached this page in error. Please report this message to our developers.\n          ")])])])])])])},l=[],c=(a("f751"),a("a481"),a("28a5"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h4",[e._v("Select field columns")]),a("strong",{staticClass:"mr-3"},[e._v("Where to find variant identifiers:")]),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.variantSpecType,expression:"variantSpecType"}],staticClass:"form-check-input",attrs:{id:"s2",type:"radio",name:"source",value:"marker"},domProps:{checked:e._q(e.variantSpecType,"marker")},on:{change:function(t){e.variantSpecType="marker"}}}),a("label",{staticClass:"form-check-label",attrs:{for:"s2"}},[e._v("Marker")])]),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.variantSpecType,expression:"variantSpecType"}],staticClass:"form-check-input",attrs:{id:"s1",type:"radio",name:"source",value:"columns"},domProps:{checked:e._q(e.variantSpecType,"columns")},on:{change:function(t){e.variantSpecType="columns"}}}),a("label",{staticClass:"form-check-label",attrs:{for:"s1"}},[e._v("Specific columns")])]),"marker"===e.variantSpecType?a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-marker"}},[e._v("Marker")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.marker_col,expression:"marker_col"}],staticClass:"form-control",attrs:{id:"vs-marker"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.marker_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,r){return a("option",{key:r,domProps:{value:r}},[e._v("\n          "+e._s(t)+"\n        ")])}))])]):a("div",[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-chr"}},[e._v("Chromosome")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.chr_col,expression:"chr_col"}],staticClass:"form-control",attrs:{id:"vs-chr",disabled:""},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.chr_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,r){return a("option",{key:r,domProps:{value:r}},[e._v("\n            "+e._s(t)+"\n          ")])}))]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-pos"}},[e._v("Position")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pos_col,expression:"pos_col"}],staticClass:"form-control",attrs:{id:"vs-pos",disabled:""},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.pos_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,r){return a("option",{key:r,domProps:{value:r}},[e._v("\n            "+e._s(t)+"\n          ")])}))])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-ref"}},[e._v("Ref allele")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.ref_col,expression:"ref_col"}],staticClass:"form-control",attrs:{id:"vs-ref"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.ref_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,r){return a("option",{key:r,domProps:{value:r}},[e._v("\n            "+e._s(t)+"\n          ")])}))]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-alt"}},[e._v("Alt allele")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.alt_col,expression:"alt_col"}],staticClass:"form-control",attrs:{id:"vs-alt"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.alt_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,r){return a("option",{key:r,domProps:{value:r}},[e._v("\n            "+e._s(t)+"\n          ")])}))])])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-pval"}},[e._v("P-value column")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pvalue_col,expression:"pvalue_col"}],staticClass:"form-control",attrs:{id:"vs-pval"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.pvalue_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,r){return a("option",{key:r,domProps:{value:r}},[e._v("\n          "+e._s(t)+"\n        ")])}))]),a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"form-check form-check-inline"},[a("label",{staticClass:"form-check-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.is_log_p,expression:"is_log_p"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.is_log_p)?e._i(e.is_log_p,null)>-1:e.is_log_p},on:{change:function(t){var a=e.is_log_p,r=t.target,o=!!r.checked;if(Array.isArray(a)){var n=null,i=e._i(a,n);r.checked?i<0&&(e.is_log_p=a.concat([n])):i>-1&&(e.is_log_p=a.slice(0,i).concat(a.slice(i+1)))}else e.is_log_p=o}}}),e._v("Uses -log(p)\n        ")])])])]),a("h4",[e._v("Preview")]),a("div",{staticClass:"row"},[a("div",{staticClass:"card card-body bg-light"},[e.isValid&&e.preview.error?a("div",[a("span",{staticClass:"text-danger"},[e._v(e._s(e.preview.error))])]):e.isValid?a("div",[e._v("\n        Variant: "+e._s(e.preview.variant)),a("br"),e._v("\n        -log(p): "+e._s(e.preview.log_pvalue)+"\n      ")]):a("div",[e._v("\n        Please select options to continue\n      ")])])]),a("div",{staticClass:"row"},[a("button",{staticClass:"btn btn-primary",on:{click:e.sendOptions}},[e._v("Accept options")])])])}),u=[],d=(a("ac6a"),a("456d"),a("7872"),a("4917"),/(?:chr)?(.+):(\d+)[_:]?(\w+)?[/:|]?([^_]+)?_?(.*)?/),p=/(?:chr)?(.+):(\d+)-(\d+)/;function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.marker_col,a=e.chr_col,o=e.pos_col,n=e.ref_col,i=e.alt_col,s=e.pvalue_col,l=e.is_log_p,c=void 0===l||l,u=e.delimiter,p=void 0===u?"\t":u;if(void 0!==t&&void 0!==a&&void 0!==o)throw new Error("Must specify either marker OR chr + pos");if(void 0===t&&(void 0===a||void 0===o))throw new Error("Must specify how to locate marker");return function(e){var l,u,v,f,m=e.split(p);if(void 0!==t){var _=m[t],h=_.match(d);if(!h)throw new Error("Could not understand marker format. Must be of format chr:pos or chr:pos_ref/alt");var g=h.slice(1),b=Object(r["a"])(g,4);l=b[0],u=b[1],v=b[2],f=b[3]}else{if(void 0===a||void 0===o)throw new Error("Must specify how to parse file");l=m[a].replace(/^chr/g,""),u=m[o],v=m[n],f=m[i]}var w=+m[s],y=c?w:-Math.log10(w);v=v||null,f=f||null;var C=v&&f?"_".concat(v,"/").concat(f):"";return{chromosome:l,position:+u,ref_allele:v,log_pvalue:y,variant:"".concat(l,":").concat(u).concat(C)}}}var f=v,m={name:"ParserOptions",props:["column_titles","sample_data","chr_col","pos_col"],data:function(){return{variantSpecType:"marker",marker_col:null,ref_col:null,alt_col:null,pvalue_col:null,is_log_p:!1}},computed:{variantSpec:function(){var e=this.marker_col,t=this.chr_col,a=this.pos_col,r=this.ref_col,o=this.alt_col;return"marker"===this.variantSpecType&&null!==e?{marker_col:e}:null!==a&&null!==t?{chr_col:t,pos_col:a,ref_col:r,alt_col:o}:{}},options:function(){var e=this.pvalue_col,t=this.is_log_p;return Object.assign({},this.variantSpec,{pvalue_col:e,is_log_p:t})},isValid:function(){var e=0!==Object.keys(this.variantSpec).length,t=null!==this.pvalue_col;return e&&t},parser:function(){return this.isValid?f(this.options):function(){}},preview:function(){try{return this.parser(this.sample_data)}catch(e){return{error:"Could not parse column contents"}}}},methods:{sendOptions:function(){this.$emit("connected",this.options)}}},_=m,h=(a("b8a9"),a("2877")),g=Object(h["a"])(_,c,u,!1,null,null,null);g.options.__file="ParserOptions.vue";var b=g.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("label",[e._v("Select a file...\n    "),a("input",{attrs:{id:"file-picker",type:"file",multiple:"",accept:"application/gzip,.tbi"},on:{change:function(t){e.addSource(t)}}})]),a("p",{attrs:{id:"validation-message"}},[e._v(e._s(e.validationMessage))])])},y=[],C=(a("7f7f"),a("aef6"),{data:function(){return{validationMessage:""}},methods:{addSource:function(e){var t=this;t.validationMessage="";for(var a,r,o=e.target.files,n=0;n<o.length;n++){var i=o.item(n);i.name.endsWith(".tbi")?a=i:r=i}if(2===o.length&&a){var s=a.name.replace(/\.gz|\.tbi/gi,"");blobReader(r,a).then(function(e){t.$emit("connected",e,s)}).catch(function(e){t.validationMessage=e})}else t.validationMessage="Must select two files: gzipped data and accompanying tabix index"}}}),k=C,x=Object(h["a"])(k,w,y,!1,null,null,null);x.options.__file="TabixFile.vue";var P=x.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.url,expression:"url",modifiers:{trim:!0}}],attrs:{type:"url",placeholder:"Specify a URL"},domProps:{value:e.url},on:{input:function(t){t.target.composing||(e.url=t.target.value.trim())},blur:function(t){e.$forceUpdate()}}}),a("button",{staticClass:"btn-primary",on:{click:e.addSource}},[e._v("Add")]),a("p",{attrs:{id:"validation-message"}},[e._v(e._s(e.validationMessage))])])},O=[],S={data:function(){return{url:"",validationMessage:""}},methods:{addSource:function(){var e=this;e.validationMessage="";var t="".concat(this.url,".tbi"),a=t.split("/").pop().replace(/\.gz|\.tbi/gi,"");urlReader(this.url,t).then(function(t){e.$emit("connected",t,a)}).catch(function(t){e.validationMessage=t})}}},R=S,A=(a("c18f"),Object(h["a"])(R,M,O,!1,null,null,null));A.options.__file="TabixUrl.vue";var j=A.exports,T={name:"adder-wizard",data:function(){return{currentPage:"select_source",readerHeaders:[],readerDataRow:"",adderMode:null,previewReader:null,previewName:null,previewParserOptions:{}}},watch:{previewReader:function(){var e=this;this.previewReader.skip||this.previewReader.fetchHeader(function(t,a){e.readerHeaders=t[t.length-1].replace(/^#+/g,"").split("\t")}),this.previewReader.fetchHeader(function(t,a){e.previewReader.skip&&(e.readerHeaders=t[e.previewReader.skip-1].replace(/^#+/g,"").split("\t")),e.readerDataRow=t[t.length-1]},{nLines:25,metaOnly:!1})}},computed:{readerChrCol:function(){return this.previewReader.colSeq-1},readerPosCol:function(){return this.previewReader.colStart-1}},methods:{connectReader:function(e,t){this.previewReader=e,this.previewName=t.replace(/[^A-Za-z0-9_]/g,"_"),this.currentPage="select_options"},connectParser:function(e){this.previewParserOptions=e,this.currentPage="accept_options"},sendOptions:function(){var e=this.previewName,t=this.previewReader,a=this.previewParserOptions;this.$emit("config-ready",e,t,Object.assign({},a)),this.$emit("close")}},components:{TabixUrl:j,TabixFile:P,ParserOptions:b}},L=T,N=(a("0259"),Object(h["a"])(L,s,l,!1,null,"789e816e",null));N.options.__file="AdderWizard.vue";var $=N.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.region,expression:"region"}],staticClass:"form-control",attrs:{type:"text",placeholder:"chr:start-end"},domProps:{value:e.region},on:{input:function(t){t.target.composing||(e.region=t.target.value)}}}),a("button",{staticClass:"btn btn-primary",on:{click:e.selectRegion}},[e._v("Go to region")]),a("span",[e._v(e._s(e.validationMessage))])])},z=[],E=(a("c5f6"),{name:"region-picker",props:{max_range:{type:Number,default:5e5}},data:function(){return{region:null,validationMessage:""}},methods:{positionToRange:function(e){var t=Math.floor(this.max_range/2);return[e-t,e+t]},selectRegion:function(){this.validationMessage="";var e,t,a,o=this.region.match(p),n=this.region.match(d);if(o){var i=o.slice(1),s=Object(r["a"])(i,3);e=s[0],t=s[1],a=s[2]}else{if(!n)return void(this.validationMessage="Could not parse specified range");var l,c=n.slice(1),u=Object(r["a"])(c,2);e=u[0],l=u[1],l=+l;var v=this.positionToRange(l),f=Object(r["a"])(v,2);t=f[0],a=f[1]}t=+t,a=+a,this.$root.$emit("select-range",{chr:e,start:t,end:a})}}}),D=E,H=(a("115a"),Object(h["a"])(D,Z,z,!1,null,"753910e6",null));H.options.__file="RegionPicker.vue";var V=H.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.items.length?a("div",[a("ul",{staticClass:"list-group"},e._l(e.items,function(t,r){return a("li",{key:r,staticClass:"list-group-item"},[e._v("\n        "+e._s(t)+"\n      ")])}))]):a("div",[e._v("\n    No studies selected\n  ")])])},G=[],W={name:"studies-vlist",props:{items:{type:Array,default:function(){return[]}}}},q=W,F=(a("f11b"),Object(h["a"])(q,U,G,!1,null,"30798cf4",null));F.options.__file="StudiesVlist.vue";var J=F.exports,K={name:"gwas-chooser",data:function(){return{showModal:!1,selections:[]}},methods:{sendConfig:function(e,t,a){this.selections.push(e),this.$root.$emit("config-ready",e,t,a)}},components:{AdderWizard:$,StudiesVlist:J,RegionPicker:V}},Y=K,I=(a("034f"),Object(h["a"])(Y,n,i,!1,null,null,null));I.options.__file="App.vue";var X=I.exports;function B(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r.id_field="variant";var o="https://portaldev.sph.umich.edu/api/v1/",n=(new LocusZoom.DataSources).add("assoc",["TabixAssociationLZ",{tabix_reader:a,params:r}]).add("ld",["LDLZ",{url:"".concat(o,"pair/LD/")}]).add("gene",["GeneLZ",{url:"".concat(o,"annotation/genes/"),params:{source:2}}]).add("catalog",["GwasCatalogLZ",{url:"".concat(o,"annotation/gwascatalog/results/"),params:{source:1}}]).add("recomb",["RecombLZ",{url:"".concat(o,"annotation/recomb/results/"),params:{source:15}}]).add("constraint",["GeneConstraintLZ",{url:"http://exac.broadinstitute.org/api/constraint"}]),i=LocusZoom.Layouts.get("plot","association_catalog",{state:{chr:"10",start:123802119,end:124202119}});i.panels[0].title={text:t};var s=LocusZoom.populate(e,n,i);return[s,n]}function Q(e,t,a,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};o.id_field="variant";var n="assoc_".concat(a);t.add(n,["TabixAssociationLZ",{tabix_reader:r,params:o}]);var i={namespace:{default:n,assoc:n,ld:"ld"},id:n,title:{text:a},y_index:-1},s=LocusZoom.Layouts.get("panel","association",i);e.addPanel(s)}LocusZoom.KnownDataSources.extend("AssociationLZ","TabixAssociationLZ",{parseInit:function(e){this.params=e.params,this.parser=f(this.params),this.reader=e.tabix_reader},getCacheKey:function(e,t,a){return[e.chr,e.start,e.end].join("_")},fetchRequest:function(e,t,a){var r=this;return new Promise(function(t,a){r.reader.fetch(e.chr,e.start,e.end,function(e,r){r&&a(r),t(e)})})},normalizeResponse:function(e){return e.map(this.parser)}}),o["a"].config.productionTip=!1;var ee=new o["a"]({render:function(e){return e(X)}}).$mount("#choose-gwas");ee.$on("config-ready",function(e,t,a){if(window.plot)Q(window.plot,window.data_sources,e,t,a);else{var o=B("#lz-plot",e,t,a),n=Object(r["a"])(o,2);window.plot=n[0],window.data_sources=n[1]}}),ee.$on("select-range",function(e){return window.plot.applyState(e)})},"7fff":function(e,t,a){},"8ff9":function(e,t,a){},b8a9:function(e,t,a){"use strict";var r=a("3064"),o=a.n(r);o.a},c18f:function(e,t,a){"use strict";var r=a("0170"),o=a.n(r);o.a},c21b:function(e,t,a){},f11b:function(e,t,a){"use strict";var r=a("8ff9"),o=a.n(r);o.a}});
//# sourceMappingURL=app.js.map