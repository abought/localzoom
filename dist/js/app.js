(function(e){function t(t){for(var o,i,n=t[0],l=t[1],c=t[2],d=0,p=[];d<n.length;d++)i=n[d],s[i]&&p.push(s[i][0]),s[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],o=!0,n=1;n<a.length;n++){var l=a[n];0!==s[l]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var o={},s={app:0},r=[];function i(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=o,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(a,o,function(t){return e[t]}.bind(null,o));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0170":function(e,t,a){},"034f":function(e,t,a){"use strict";var o=a("c21b"),s=a.n(o);s.a},"17cf":function(e,t,a){},4866:function(e,t,a){"use strict";var o=a("9672"),s=a.n(o);s.a},"56d7":function(e,t,a){"use strict";a.r(t);var o=a("9393"),s=(a("cadf"),a("551c"),a("097d"),a("2b0e")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[e.studyCount<e.maxStudies?a("div",{staticClass:"col-sm-6"},[a("tabix-file",{staticClass:"mr-1",on:{connected:e.connectReader,fail:e.showMessage}}),a("bs-dropdown",{attrs:{text:"Add from URL",variant:"success"}},[a("div",{staticClass:"px-3"},[a("tabix-url",{on:{connected:e.connectReader,fail:e.showMessage}})],1)]),e.showModal?a("adder-wizard",{attrs:{file_reader:e.fileReader,file_name:e.displayName},on:{"update:file_name":function(t){e.displayName=t},"config-ready":e.sendConfig,close:function(t){e.showModal=!1}}}):e._e()],1):e._e(),a("div",{staticClass:"col-sm-6"},[e.studyCount?a("region-picker",{staticClass:"float-right",attrs:{build:e.build,max_range:"500000",search_url:"https://portaldev.sph.umich.edu/api_internal_dev/v1/annotation/omnisearch/"},on:{fail:e.showMessage}}):a("bs-dropdown",{staticClass:"float-right",attrs:{text:"Plot options",variant:"info"}},[a("div",{staticClass:"px-3"},[a("strong",[e._v("Annotations")]),a("br"),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.hasCatalog,expression:"hasCatalog"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"show-catalog"},domProps:{checked:Array.isArray(e.hasCatalog)?e._i(e.hasCatalog,null)>-1:e.hasCatalog},on:{change:function(t){var a=e.hasCatalog,o=t.target,s=!!o.checked;if(Array.isArray(a)){var r=null,i=e._i(a,r);o.checked?i<0&&(e.hasCatalog=a.concat([r])):i>-1&&(e.hasCatalog=a.slice(0,i).concat(a.slice(i+1)))}else e.hasCatalog=s}}}),a("label",{staticClass:"form-check-label",attrs:{for:"show-catalog"}},[e._v("GWAS Catalog")])]),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.hasCredibleSets,expression:"hasCredibleSets"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"show-credible-set"},domProps:{checked:Array.isArray(e.hasCredibleSets)?e._i(e.hasCredibleSets,null)>-1:e.hasCredibleSets},on:{change:function(t){var a=e.hasCredibleSets,o=t.target,s=!!o.checked;if(Array.isArray(a)){var r=null,i=e._i(a,r);o.checked?i<0&&(e.hasCredibleSets=a.concat([r])):i>-1&&(e.hasCredibleSets=a.slice(0,i).concat(a.slice(i+1)))}else e.hasCredibleSets=s}}}),a("label",{staticClass:"form-check-label",attrs:{for:"show-credible-set"}},[e._v("95% credible set")])]),a("strong",[e._v("Genome Build")]),a("br"),a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.build,expression:"build"}],staticClass:"form-check-input",attrs:{type:"radio",id:"build-37",name:"build",value:"GRCh37"},domProps:{checked:e._q(e.build,"GRCh37")},on:{change:function(t){e.build="GRCh37"}}}),a("label",{staticClass:"form-check-label",attrs:{for:"build-37"}},[e._v("GRCh37")])]),a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.build,expression:"build"}],staticClass:"form-check-input",attrs:{type:"radio",id:"build-38",name:"build",value:"GRCh38"},domProps:{checked:e._q(e.build,"GRCh38")},on:{change:function(t){e.build="GRCh38"}}}),a("label",{staticClass:"form-check-label",attrs:{for:"build-38"}},[e._v("GRCh38")])])])])],1)]),e.message?a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("span",{class:[e.messageClass]},[e._v(e._s(e.message))])])]):e._e()])},i=[],n=(a("f751"),a("e14e")),l=a("0096"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{staticClass:"modal-container"},[a("div",{staticClass:"modal-header"},[a("h3",[e._v("Select file options...")]),a("button",{staticClass:"pull-right",attrs:{"aria-label":"close"},on:{click:function(t){e.$emit("close")}}},[e._v("X\n          ")])]),a("div",{staticClass:"modal-body"},[a("div",[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-3",attrs:{for:"display_name"}},[e._v("Dataset Label")]),a("div",{staticClass:"col-sm-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.file_name,expression:"file_name"}],staticClass:"form-control",attrs:{id:"display_name",type:"text"},domProps:{value:e.file_name},on:{input:function(t){t.target.composing||(e.file_name=t.target.value)}}})])]),a("bs-tabs",{model:{value:e.variant_spec_tab,callback:function(t){e.variant_spec_tab=t},expression:"variant_spec_tab"}},[a("bs-tab",{staticClass:"pt-3",attrs:{title:"Presets"}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-preset"}},[e._v("Program")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.preset_type,expression:"preset_type"}],staticClass:"form-control",attrs:{id:"vs-preset"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.preset_type=t.target.multiple?a:a[0]}}},e._l(e.preset_options,function(t){return a("option",{key:t,domProps:{value:t}},[e._v("\n                        "+e._s(t)+"\n                      ")])}))])]),a("p",[a("em",[e._v("If your program is not listed, choose another tab and specify how to read\n                    your file.")])])]),a("bs-tab",{staticClass:"pt-3",attrs:{title:"Variant from columns"}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-chr"}},[e._v("Chromosome")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.chr_col,expression:"chr_col"}],staticClass:"form-control",attrs:{id:"vs-chr",disabled:""},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.chr_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,o){return a("option",{key:o,domProps:{value:o}},[e._v("\n                        "+e._s(t)+"\n                      ")])}))]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-pos"}},[e._v("Position")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pos_col,expression:"pos_col"}],staticClass:"form-control",attrs:{id:"vs-pos",disabled:""},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.pos_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,o){return a("option",{key:o,domProps:{value:o}},[e._v("\n                        "+e._s(t)+"\n                      ")])}))])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-ref"}},[e._v("Ref allele")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.ref_col,expression:"ref_col"}],staticClass:"form-control",attrs:{id:"vs-ref"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.ref_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,o){return a("option",{key:o,domProps:{value:o}},[e._v("\n                        "+e._s(t)+"\n                      ")])}))]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-alt"}},[e._v("Alt allele")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.alt_col,expression:"alt_col"}],staticClass:"form-control",attrs:{id:"vs-alt"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.alt_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,o){return a("option",{key:o,domProps:{value:o}},[e._v("\n                        "+e._s(t)+"\n                      ")])}))])])]),a("bs-tab",{staticClass:"pt-3",attrs:{title:"Variant from marker"}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-marker"}},[e._v("Marker")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.marker_col,expression:"marker_col"}],staticClass:"form-control",attrs:{id:"vs-marker"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.marker_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,o){return a("option",{key:o,domProps:{value:o}},[e._v("\n                        "+e._s(t)+"\n                      ")])}))])])])],1),0!==e.variant_spec_tab?a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-pval"}},[e._v("P-value column")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pvalue_col,expression:"pvalue_col"}],staticClass:"form-control",attrs:{id:"vs-pval"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.pvalue_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,function(t,o){return a("option",{key:o,domProps:{value:o}},[e._v("\n                    "+e._s(t)+"\n                  ")])}))]),a("div",{staticClass:"col-sm-2"},[a("label",{staticClass:"form-check-label",staticStyle:{"white-space":"nowrap"},attrs:{for:"is_log_p"}},[e._v("\n                  Uses "),a("em",[e._v("-log"),a("sub",[e._v("10")]),e._v("(p)")])])]),a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"form-check float-left"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.is_log_p,expression:"is_log_p"}],staticClass:"form-check-input",attrs:{id:"is_log_p",type:"checkbox"},domProps:{checked:Array.isArray(e.is_log_p)?e._i(e.is_log_p,null)>-1:e.is_log_p},on:{change:function(t){var a=e.is_log_p,o=t.target,s=!!o.checked;if(Array.isArray(a)){var r=null,i=e._i(a,r);o.checked?i<0&&(e.is_log_p=a.concat([r])):i>-1&&(e.is_log_p=a.slice(0,i).concat(a.slice(i+1)))}else e.is_log_p=s}}})])])]):e._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"card card-body bg-light"},[e.isValid&&e.preview.error?a("div",[a("span",{staticClass:"text-danger"},[e._v(e._s(e.preview.error))])]):e.isValid?a("div",[e._v("\n                  Variant: "+e._s(e.preview.variant)),a("br"),e._v("\n                  -log"),a("sub",[e._v("10")]),e._v("(p): "+e._s(e.preview.log_pvalue.toFixed(3))+"\n                ")]):a("div",[e._v("\n                  Please select options to preview parsed data\n                ")])])]),a("div",{staticClass:"row mt-3"},[a("button",{staticClass:"btn btn-primary ml-auto",attrs:{disabled:!e.isValid},on:{click:e.sendOptions}},[e._v("\n                Accept options\n              ")])])],1)])])])])])},u=[],d=(a("a481"),a("28a5"),a("ac6a"),a("456d"),a("40bb")),p=a("a212"),m=(a("7872"),a("4917"),/(?:chr)?(.+):(\d+)[_:]?(\w+)?[/:|]?([^_]+)?_?(.*)?/),f=/(?:chr)?(.+):(\d+)-(\d+)/,v={epacts:{marker_col:3,pvalue_col:8,is_log_p:!1},saige:{marker_col:2,pvalue_col:11,is_log_p:!1},plink:{marker_col:1,pvalue_col:8,is_log_p:!1},"bolt-lmm":{chr_col:1,pos_col:2,ref_col:5,alt_col:4,pvalue_col:10,is_log_p:!1}};function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.marker_col,a=e.chr_col,s=e.pos_col,r=e.ref_col,i=e.alt_col,n=e.pvalue_col,l=e.is_log_p,c=void 0!==l&&l,u=e.delimiter,d=void 0===u?"\t":u;if(void 0!==t&&void 0!==a&&void 0!==s)throw new Error("Must specify either marker OR chr + pos");if(void 0===t&&(void 0===a||void 0===s))throw new Error("Must specify how to locate marker");return function(e){var l,u,p,f,v=e.split(d);if(void 0!==t){var _=v[t],h=_.match(m);if(!h)throw new Error("Could not understand marker format. Must be of format chr:pos or chr:pos_ref/alt");var g=h.slice(1),b=Object(o["a"])(g,4);l=b[0],u=b[1],p=b[2],f=b[3]}else{if(void 0===a||void 0===s)throw new Error("Must specify how to parse file");l=v[a].replace(/^chr/g,""),u=v[s],p=v[r],f=v[i]}var C=+v[n],y=c?C:-Math.log10(C);p=p||null,f=f||null;var w=p&&f?"_".concat(p,"/").concat(f):"";return{chromosome:l,position:+u,ref_allele:p,alt_allele:f,log_pvalue:y,variant:"".concat(l,":").concat(u).concat(w)}}}var h={name:"adder-wizard",mounted:function(){var e=this;document.body.addEventListener("keyup",function(t){"Escape"===t.key&&e.$emit("close")})},props:["file_reader","file_name"],data:function(){return{column_titles:[],sample_data:"",variant_spec_tab:0,preset_options:Object.keys(v),preset_type:null,marker_col:null,ref_col:null,alt_col:null,pvalue_col:null,is_log_p:!1}},watch:{file_reader:{immediate:!0,handler:function(){var e=this;this.file_reader.skip||this.file_reader.fetchHeader(function(t,a){e.column_titles=t[t.length-1].replace(/^#+/g,"").split("\t")}),this.file_reader.fetchHeader(function(t,a){e.file_reader.skip&&(e.column_titles=t[e.file_reader.skip-1].replace(/^#+/g,"").split("\t")),e.sample_data=t[t.length-1]},{nLines:25,metaOnly:!1})}}},computed:{chr_col:function(){return this.file_reader.colSeq-1},pos_col:function(){return this.file_reader.colStart-1},variantSpec:function(){var e=this.marker_col,t=this.chr_col,a=this.pos_col,o=this.ref_col,s=this.alt_col;return 0===this.variant_spec_tab&&this.preset_type?v[this.preset_type]:2===this.variant_spec_tab&&null!==e?{marker_col:e}:1===this.variant_spec_tab&&null!==a&&null!==t?{chr_col:t,pos_col:a,ref_col:o,alt_col:s}:{}},parserOptions:function(){var e=this.pvalue_col,t=this.is_log_p;return Object.assign({},{pvalue_col:e,is_log_p:t},this.variantSpec)},isValid:function(){var e=0!==Object.keys(this.variantSpec).length,t=null!==this.parserOptions.pvalue_col;return e&&t},parser:function(){return this.isValid?_(this.parserOptions):function(){}},preview:function(){try{return this.parser(this.sample_data)}catch(e){return{error:"Could not parse column contents"}}}},methods:{sendOptions:function(){var e=this.preview.position,t={chr:this.preview.chromosome,start:Math.max(0,e-25e4),end:e+25e4};this.$emit("config-ready",Object.assign({},this.parserOptions),t),this.$emit("close")}},components:{bsTab:p["a"],bsTabs:d["a"]}},g=h,b=(a("c1b0"),a("2877")),C=Object(b["a"])(g,c,u,!1,null,"1328832d",null);C.options.__file="AdderWizard.vue";var y=C.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-inline"},[a("vue-bootstrap-typeahead",{attrs:{data:e.search_results,serializer:function(e){return e.term},"min-matching-chars":"3",placeholder:"chr:start-end"},model:{value:e.region,callback:function(t){e.region=t},expression:"region"}}),a("button",{staticClass:"btn btn-primary",on:{click:e.selectRegion}},[e._v("Go to region")])],1)},k=[],x=(a("7514"),a("c5f6"),a("17fb")),S=a("d45f"),O={name:"region-picker",components:{VueBootstrapTypeahead:S["a"]},props:{max_range:{type:Number,default:5e5},search_url:{type:String,default:"https://portaldev.sph.umich.edu/api_internal_dev/v1/annotation/omnisearch/"},build:{type:String,required:!0}},data:function(){return{region:null,search_results:[]}},methods:{positionToRange:function(e){var t=Math.floor(this.max_range/2);return[e-t,e+t]},selectRegion:function(){var e=this;if(this.region){var t,a,s,r=this.region.match(f),i=this.region.match(m),n=this.search_results.find(function(t){return e.region===t.term});if(n){t=n.chrom,a=n.start,s=n.end;var l=this.positionToRange((a+s)/2),c=Object(o["a"])(l,2);a=c[0],s=c[1]}else if(r){var u=r.slice(1),d=Object(o["a"])(u,3);if(t=d[0],a=d[1],s=d[2],a=+a,s=+s,s-a>this.max_range)return void this.$emit("fail","Maximum allowable range is ".concat(this.max_range))}else{if(!i)return void this.$emit("fail","Could not parse specified range");var p,v=i.slice(1),_=Object(o["a"])(v,2);t=_[0],p=_[1],p=+p;var h=this.positionToRange(p),g=Object(o["a"])(h,2);a=g[0],s=g[1]}this.$root.$emit("select-range",{chr:t,start:a,end:s}),this.$emit("fail","","")}else this.$emit("fail","Please specify a region")},doSearch:function(){var e=this,t="".concat(this.search_url,"?q=").concat(encodeURIComponent(this.region),"&build=").concat(encodeURIComponent(this.build));fetch(t).then(function(e){return e.json()}).then(function(t){e.search_results=t.data.filter(function(e){return!e.error})})}},watch:{region:Object(x["debounce"])(function(){this.doSearch()},500)}},L=O,A=(a("4866"),Object(b["a"])(L,w,k,!1,null,"6ce4f196",null));A.options.__file="RegionPicker.vue";var R=A.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("label",{staticClass:"btn btn-success mb-0",attrs:{for:"file-picker"}},[e._v("Add a file...")]),a("input",{staticStyle:{opacity:"0",width:"0",height:"0"},attrs:{id:"file-picker",type:"file",multiple:"",accept:"application/gzip,.tbi"},on:{change:function(t){e.addSource(t)}}})])},j=[],N=(a("7f7f"),a("aef6"),{methods:{addSource:function(e){for(var t,a,o=this,s=e.target.files,r=0;r<s.length;r++){var i=s.item(r);i.name.endsWith(".tbi")?t=i:a=i}if(2===s.length&&t){var n=t.name.replace(/\.gz|\.tbi/gi,"");blobReader(a,t).then(function(e){o.$emit("connected",e,n)}).catch(function(e){o.$emit("fail",e)}).finally(function(){e.target.value=null})}else o.$emit("fail","Must select two files: gzipped data and accompanying tabix index")}}}),M=N,Z=Object(b["a"])(M,P,j,!1,null,null,null);Z.options.__file="TabixFile.vue";var T=Z.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-inline flex-nowrap"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.url,expression:"url",modifiers:{trim:!0}}],staticClass:"form-control mr-1",attrs:{type:"url",placeholder:"Specify a URL"},domProps:{value:e.url},on:{input:function(t){t.target.composing||(e.url=t.target.value.trim())},blur:function(t){e.$forceUpdate()}}}),a("button",{staticClass:"btn btn-success",on:{click:e.addSource}},[e._v("Add")])])},E=[],z={data:function(){return{url:""}},methods:{addSource:function(){var e=this,t="".concat(this.url,".tbi"),a=t.split("/").pop().replace(/\.gz|\.tbi/gi,"");urlReader(this.url,t).then(function(t){e.$emit("connected",t,a)}).catch(function(t){e.$emit("fail",t)})}}},D=z,V=(a("c18f"),Object(b["a"])(D,G,E,!1,null,null,null));V.options.__file="TabixUrl.vue";var q=V.exports,U={name:"gwas-chooser",data:function(){return{showModal:!1,studyCount:0,maxStudies:3,message:"",messageClass:"",fileReader:null,displayName:null,hasCatalog:!1,hasCredibleSets:!1,build:"GRCh37"}},methods:{reset:function(){this.fileReader=null,this.displayName=null,this.message="",this.messageClass=""},showMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text-danger";this.message=e,this.messageClass=t},connectReader:function(e,t){this.fileReader=e,this.displayName=t,this.showModal=!0},sendConfig:function(e,t){this.studyCount+=1;var a={gwas_catalog:this.hasCatalog,credible_sets:this.hasCredibleSets},o=this.build;this.$root.$emit("config-ready",{label:this.displayName,reader:this.fileReader,parser_config:e},{annotations:a,build:o,state:Object.assign({genome_build:this.build},t)}),this.reset()}},components:{bsDropdown:n["a"],bsDropdownItem:l["a"],AdderWizard:y,RegionPicker:R,TabixFile:T,TabixUrl:q}},I=U,W=(a("034f"),Object(b["a"])(I,r,i,!1,null,null,null));W.options.__file="App.vue";var B=W.exports,F=a("8afe");a("8615"),a("ee1d");function H(e){return e.replace(/[^A-Za-z0-9_]/g,"_")}function J(e){var t,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{credible_sets:!1,gwas_catalog:!0},s=(arguments.length>2&&arguments[2],[]),r=H(e),i={assoc:"assoc_".concat(r),credset:"credset_".concat(r),catalog:"catalog"},n=LocusZoom.Layouts.get("panel","association",{id:"association_".concat(r),title:{text:e},namespace:i}),l=n.data_layers[2],c=l.tooltip,u=[];Object.values(o).some(function(e){return!!e})&&u.push({type:"display_options",position:"right",color:"blue",button_html:"Display options...",button_title:"Control how plot items are displayed",layer_name:"associationpvalues",default_config_display_name:"Default view",options:[]});var d=[];if(o.credible_sets){var p,m=LocusZoom.Layouts.get("panel","association_credible_set",{namespace:i});(p=u[0].options).push.apply(p,Object(F["a"])(m.dashboard.components.pop().options)),d.push("{{namespace[credset]}}posterior_prob","{{namespace[credset]}}contrib_fraction","{{namespace[credset]}}is_member"),c.html+="<br>Posterior probability: <strong>{{{{namespace[credset]}}posterior_prob|scinotation}}</strong><br>"}if(o.gwas_catalog){var f,v=LocusZoom.Layouts.get("panel","association_catalog",{namespace:i});(f=u[0].options).push.apply(f,Object(F["a"])(v.dashboard.components.pop().options)),d.push("{{namespace[catalog]}}rsid","{{namespace[catalog]}}trait","{{namespace[catalog]}}log_pvalue"),c.html+='{{#if {{namespace[catalog]}}rsid}}<br><a href="https://www.ebi.ac.uk/gwas/search?query={{{{namespace[catalog]}}rsid}}" target="_new">See hits in GWAS catalog</a>{{/if}}'}return(t=l.fields).push.apply(t,d),(a=n.dashboard.components).push.apply(a,u),s.push(LocusZoom.Layouts.get("panel","association",n)),o.gwas_catalog&&s.push(LocusZoom.Layouts.get("panel","annotation_catalog",{id:"catalog_".concat(r),namespace:i})),s}function K(e,t,a){var o=t.label,s=t.reader,r=t.parser_config;r.id_field="variant";var i="assoc_".concat(H(o));return e.add(i,["TabixAssociationLZ",{tabix_reader:s,params:r}]),e.add("credset_".concat(H(o)),["CredibleSetLZ",{params:{fields:{log_pvalue:"".concat(i,":log_pvalue")},threshold:.95}}]),J(o,a.annotations,a.build)}function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{label:null,reader:null,parser_config:null},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{annotations:{},state:{}};t.parser_config.id_field="variant";var o="https://portaldev.sph.umich.edu/api/v1/",s="https://portaldev.sph.umich.edu/api_internal_dev/v1/",r=new LocusZoom.DataSources,i=K(r,t,a);i.push(LocusZoom.Layouts.get("panel","genes",{proportional_height:.5}));var n=LocusZoom.Layouts.get("plot","standard_association",{state:a.state,panels:i});r.add("catalog",["GwasCatalogLZ",{url:"".concat(o,"annotation/gwascatalog/results/")}]).add("ld",["LDLZ2",{url:"https://portaldev.sph.umich.edu/ld/",params:{source:"1000G",population:"ALL"}}]).add("gene",["GeneLZ",{url:"".concat(o,"annotation/genes/")}]).add("recomb",["RecombLZ",{url:"".concat(s,"annotation/recomb/results/")}]).add("constraint",["GeneConstraintLZ",{url:"http://exac.broadinstitute.org/api/constraint"}]);var l=LocusZoom.populate(e,r,n);return l.layout.panels.forEach(function(e){return l.panels[e.id].addBasicLoader()}),[l,r]}function Q(e,t,a,o){var s=K(t,a,o);s.forEach(function(t){t.y_index=-1;var a=e.addPanel(t);a.addBasicLoader()})}function Y(e,t){var a=e.getValue();return LocusZoom.TransformationFunctions.get("scinotation")(a)}function ee(e){return[{title:"Variant",field:"assoc_".concat(e,":variant")},{title:"Chrom",field:"assoc_".concat(e,":chromosome")},{title:"Pos",field:"assoc_".concat(e,":position")},{title:"Ref",field:"assoc_".concat(e,":ref_allele")},{title:"Alt",field:"assoc_".concat(e,":alt_allele")},{title:"-log10 pvalue",field:"assoc_".concat(e,":log_pvalue"),formatter:Y},{title:"Posterior probability",field:"credset_".concat(e,":posterior_prob"),formatter:Y}]}LocusZoom.KnownDataSources.extend("AssociationLZ","TabixAssociationLZ",{parseInit:function(e){this.params=e.params,this.parser=_(this.params),this.reader=e.tabix_reader},getCacheKey:function(e,t,a){return[e.chr,e.start,e.end].join("_")},fetchRequest:function(e,t,a){var o=this;return new Promise(function(t,a){o.reader.fetch(e.chr,e.start,e.end,function(e,o){o&&a(new Error("Could not read requested region. This may indicate an error with the .tbi index.")),t(e)})})},normalizeResponse:function(e){return e.map(this.parser).filter(function(e){return!Number.isNaN(e.log_pvalue)})}});s["a"].config.productionTip=!1;var te="#lz-plot",ae=$("#credible-set-table"),oe=$("#credible-set-datasets"),se=$("#credible-set-download"),re=new s["a"]({render:function(e){return e(B)}}).$mount("#choose-gwas");re.$on("config-ready",function(e,t){if(window.plot)Q(window.plot,window.data_sources,e,t);else{var a=X(te,e,t),s=Object(o["a"])(a,2);window.plot=s[0],window.data_sources=s[1],t.annotations.credible_sets&&$("#credible-set-ui").removeClass("d-none")}t.annotations.credible_sets&&$('<option value="'.concat(e.label,'">').concat(e.label,"</option>")).appendTo(oe)}),re.$on("select-range",function(e){return window.plot.applyState(e)}),ae.tabulator({index:"id",height:300,layout:"fitColumns",layoutColumnsOnNewData:!0}),oe.change(function(){se.removeClass("d-none"),ae.removeClass("d-none");var e=$(this).val(),t=H(e),a=ee(t);ae.tabulator("setColumns",a),ae.tabulator("setSort","credset_".concat(t,":posterior_prob"),"desc"),window.plot.subscribeToData(["assoc_".concat(t,":variant"),"assoc_".concat(t,":chromosome"),"assoc_".concat(t,":position"),"assoc_".concat(t,":ref_allele"),"assoc_".concat(t,":alt_allele"),"assoc_".concat(t,":log_pvalue"),"credset_".concat(t,":is_member"),"credset_".concat(t,":posterior_prob")],function(e){var a=e.filter(function(e){return e["credset_".concat(t,":is_member")]});ae.tabulator("setData",a)}),window.plot.emit("data_rendered")}),se.on("click",function(){ae.tabulator("download","csv","credible-set-members.csv")})},9672:function(e,t,a){},c18f:function(e,t,a){"use strict";var o=a("0170"),s=a.n(o);s.a},c1b0:function(e,t,a){"use strict";var o=a("17cf"),s=a.n(o);s.a},c21b:function(e,t,a){}});
//# sourceMappingURL=app.js.map