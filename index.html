<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
        integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

  <link rel="stylesheet" href="dist/css/app.css">

  <!-- Necessary includes for LocusZoom.js -->
  <!-- FIXME: This branch sources pre-release code from  -->
  <link rel="stylesheet" href="https://abought.github.io/locuszoom/dist/locuszoom.css" type="text/css"/>
  <script src="https://abought.github.io/locuszoom/dist/locuszoom.vendor.min.js" type="application/javascript"></script>
  <script src="https://abought.github.io/locuszoom/dist/locuszoom.app.min.js" type="application/javascript"></script>

  <!-- Extensions for credible sets -->
  <script type="application/javascript" src="https://unpkg.com/gwas-credible-sets@0.1.0/dist/gwas-credible-sets.min.js" integrity="sha384-lJL/xQT18Xu6GVovitlKgX4kL8hw6YfgLGVM5PWcFUMe+tfvznEwsJlauLzB1AnQ" crossorigin="anonymous"></script>
  <script src="https://abought.github.io/locuszoom/dist/ext/lz-credible-sets.min.js" type="application/javascript"></script>

  <!-- For "table of results" feature -->
  <script type="application/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT" crossorigin="anonymous"></script>
  <script type="application/javascript" src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha384-Dziy8F2VlJQLMShA6FHWNul/veM9bCkRUaLqr199K94ntO5QUrLJBEbYegdSkkqX" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/3.5.1/css/tabulator.min.css" integrity="sha384-uUckT6+9734bUz7HdTJ+c+PuMby2lpJoY32bbSz5AxNsX0HafyKd17e654uUdw1x" crossorigin="anonymous">
  <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/3.5.1/js/tabulator.min.js" integrity="sha384-RpPuANG8/tgp6BYEwkavx0+frMPygzCmFcKd8bLQ4ReTROYaqH1h/mMgVLeA4cCX" crossorigin="anonymous"></script>

  <!-- FIXME: Vue build fails when `import`ing a UMD bundle; include file separately for now -->
  <script src="external/dalliance-tabix-reader.js" type="application/javascript"></script>

  <title>LocusZoom.js ~ Plot your own Tabixed Data</title>

  <style>
    body {
      background-color: #FAFAFA;
      margin: 0px 20px;
    }

    img {
      max-width: 100%;
      box-sizing: border-box;
    }

    .placeholder-plot {
      width: 100%;
      height: 400px;
      border-style: dashed;
    }

    .collapse-open::before {
      content: "-";
      margin-right:10px;
    }

    .collapse-closed::before {
      content: "+";
      margin-right:10px;
    }
  </style>

</head>

<body>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <h1 style="margin-top: 1em;"><strong>LocusZoom.js</strong></h1>

      <h3 style="color: #777">Using LZ.js without an API</h3>

      <hr>

      <div class="card">
        <div class="card-header">
          <h3>
            <a id="instructions-header" class="collapse-closed">Instructions</a>
          </h3>
        </div>
        <div id="instructions-text" class="card-body card-text d-none"
             aria-labelledby="instructions-header">
          This is a demonstration of loading GWAS results via the web browser, fetching only the
          data
          required for that region. It relies on four assumptions:
          <ol>
            <li>Your data has been stored in a compressed format, and indexed using Tabix. The index
              must be in the same path, with the suffix <em>.tbi</em></li>
            <li>The data is hosted in a place that is reachable by web browser (eg local files or a
              service such as S3)
            </li>
            <li>If using a remote URL, the host location must support byte range requests. (<a
                href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests#Checking_if_a_server_supports_partial_requests">how
              to check</a>)
            </li>
            <li>Your file contains two key columns of information: a SNP marker in the format
              <code>chr:pos_ref/alt</code>, and a p-value (or -log10 pvalue) for each row.
              <em>Client-side plots cannot be generated from rsIDs.</em></li>
          </ol>

          <p>This service is designed to efficiently fetch only the data needed for the plot region
            of
            interest. Therefore, it cannot generate summary views that would require processing the
            entire file (eg Manhattan plots).</p>

          <p>LD and overlay information is based on <strong>build GRCh37</strong>. Exercise caution
            when interpreting plots based on a GWAS with positions from a different build.</p>
        </div>
      </div>
    </div>
  </div>

  <hr>

  <div class="row">
    <div class="col-md-8">
      <div id="lz-plot" class="lz-container-responsive">
        <div class="placeholder-plot" style="display:table;">
          <span class="text-center" style="display: table-cell; vertical-align:middle">Please add a GWAS track to continue</span>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div id="choose-gwas"></div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <h3>Credible set members</h3>
      <button id="download-credsets" class="btn-primary">Download as CSV</button><br>
      <div id="table-credsets"></div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <footer style="text-align: center;">
        &copy; Copyright 2018 <a href="https://github.com/statgen">The University of Michigan Center
        for Statistical
        Genetics</a><br>
      </footer>
    </div>
  </div>
</div>

<script src="dist/js/chunk-vendors.js"></script>
<script src="dist/js/app.js"></script>

<script type="application/javascript">
  $('#instructions-header').click(function() {
      $(this).toggleClass('collapse-open').toggleClass('collapse-closed');
      $('#instructions-text').toggleClass('d-none');
  });
</script>

</body>
</html>
